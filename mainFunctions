function createAndArrangeReservationSlots() {
  // 予約枠を作成
  createReservationSlot();
  SpreadsheetApp.flush();

  handleReservations();
}

function onFormSubmit() {
  // フォームの回答をリストに転記
  transferFormResponses();
  SpreadsheetApp.flush();

  handleReservations();
}

function handleReservations() {
  // 未予約のスロットを予約
  bookUnreservedSlots();
  SpreadsheetApp.flush();

  // カレンダーの予約枠を調整
  adjustReservationCalendar();
  SpreadsheetApp.flush();

  // フォームの予約枠を更新
  updateReservationForm();
}
